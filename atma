#!/usr/bin/env node

(function() {

	require('atma-libs/globals-dev');
	require('./src/app.help.js');
	require('socket.io');

	include.cfg({
		path: 'file:///' + __dirname.replace(/\\/g, '/') + '/',
		lockedToFolder: true,
		loader: {
			coffee: '/node_modules/atma-libs/include/loader/coffee/loader.js'
		}
	}).routes({
		
		handler: '/src/handler/{0}.js',
		parser: '/src/parser/{0}.js',
		action: '/src/action/{0}.js',
		script: '/src/{0}.js',
		helper: '/src/helper/{0}.js',
		base: '/src/base/{0}.js',
		io: '/src/io/{0}.js',
		server: '/src/server/{0}.js'
	}).js({
		_: [
			'/src/helper/logger.js',
			'/src/utils/exports.js'
		],
		settings: '/src/app.settings.js',
		parser: ['config'],
		script: [ 
			'helper/colorize', 
			'helper/extensions', 
		],
		io: 'package',
		
		//
		action: 'action-processor::Action'
	}).done(function(resp) {
		
		Log('PROCESS', process, 99);
		Log('CONFIG', global.config, 99);


		if (!(global.config && global.config.state == 4)) {
			console.error('Invalid Config', global.config)
			return 0;
		}

		(new resp['Action']()).run(global.config);


		return 1;

	});


}());
